<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Majestic - Olivia First Reading</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
        'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      background: linear-gradient(to bottom, #f0fdf4, #ffffff);
      min-height: 100vh;
    }

    .container {
      padding: 3rem 1.5rem;
      max-width: 600px;
      margin: 0 auto;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 2rem;
    }

    .avatar-icon {
      width: 3rem;
      height: 3rem;
      border-radius: 50%;
      background: linear-gradient(135deg, #6b8e23, #556b2f);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
    }

    .avatar-info h2 {
      font-size: 1.25rem;
      font-weight: 500;
      color: #a8b896;
    }

    .avatar-info p {
      font-size: 0.875rem;
      color: #c4d4ba;
    }

    .content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .message-box {
      background: white;
      border-radius: 1.5rem;
      padding: 1.5rem;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      border: 1px solid #e5e7eb;
      margin-bottom: 2rem;
    }

    .message-box p {
      color: #374151;
      line-height: 1.6;
      margin-bottom: 1rem;
    }

    .message-box p:last-child {
      margin-bottom: 0;
    }

    .btn-primary {
      width: 100%;
      background: #6b8e23;
      color: white;
      padding: 1rem;
      border-radius: 9999px;
      font-size: 1.125rem;
      font-weight: 500;
      border: none;
      cursor: pointer;
      transition: background 0.2s;
    }

    .btn-primary:hover {
      background: #556b2f;
    }

    .card-display {
      width: 16rem;
      height: 24rem;
      background: linear-gradient(to bottom right, #8fbc8f, #6b8e23);
      border-radius: 1rem;
      margin: 0 auto 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1);
    }

    .card-content {
      text-align: center;
      color: white;
    }

    .card-number {
      font-size: 4rem;
      margin-bottom: 1rem;
    }

    .card-name {
      font-size: 1.5rem;
      font-weight: 300;
      letter-spacing: 0.1em;
    }

    .card-info {
      text-align: center;
      margin-bottom: 2rem;
    }

    .card-info h3 {
      font-size: 1.875rem;
      font-weight: 300;
      margin-bottom: 0.5rem;
      color: #1f2937;
      letter-spacing: 0.025em;
    }

    .keywords {
      display: flex;
      gap: 0.5rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .keyword {
      padding: 0.25rem 0.75rem;
      background: #c4d4ba;
      color: #00695c;
      border-radius: 9999px;
      font-size: 0.875rem;
    }

    .shuffling-screen {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }

    .shuffling-card {
      width: 8rem;
      height: 12rem;
      background: linear-gradient(to bottom right, #8fbc8f, #6b8e23);
      border-radius: 1rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .shuffling-text {
      color: #4b5563;
      animation: pulse 2s infinite;
    }

    .mini-card {
      display: flex;
      align-items: center;
      gap: 1rem;
      background: white;
      border-radius: 1rem;
      padding: 1rem;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      border: 1px solid #e5e7eb;
      margin-bottom: 1.5rem;
    }

    .mini-card-img {
      width: 4rem;
      height: 6rem;
      background: linear-gradient(to bottom right, #8fbc8f, #6b8e23);
      border-radius: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.5rem;
      font-weight: 300;
    }

    .mini-card-info h3 {
      font-weight: 500;
      color: #1f2937;
    }

    .mini-card-info p {
      font-size: 0.875rem;
      color: #6b7280;
    }

    .interpretation-box {
      background: white;
      border-radius: 1.5rem;
      padding: 1.5rem;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      border: 1px solid #e5e7eb;
      margin-bottom: 1.5rem;
    }

    .olivia-message {
      display: flex;
      gap: 0.75rem;
      align-items: start;
    }

    .olivia-avatar {
      width: 2.5rem;
      height: 2.5rem;
      border-radius: 50%;
      background: #c4d4ba;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      font-size: 1.25rem;
    }

    .olivia-text {
      flex: 1;
      color: #374151;
      line-height: 1.6;
      white-space: pre-line;
    }

    .strengths-box {
      background: white;
      border-radius: 1rem;
      padding: 1.5rem;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      border: 1px solid #e5e7eb;
      margin-bottom: 1.5rem;
    }

    .strengths-box h4 {
      font-weight: 500;
      color: #1f2937;
      margin-bottom: 1rem;
    }

    .item {
      display: flex;
      gap: 0.75rem;
      align-items: start;
      margin-bottom: 0.75rem;
    }

    .item:last-child {
      margin-bottom: 0;
    }

    .dot {
      width: 0.5rem;
      height: 0.5rem;
      border-radius: 50%;
      margin-top: 0.5rem;
      flex-shrink: 0;
    }

    .dot-olive {
      background: #8fbc8f;
    }

    .dot-amber {
      background: #f59e0b;
    }

    .item-content p:first-child {
      font-weight: 500;
      color: #1f2937;
      font-size: 0.875rem;
      margin-bottom: 0.25rem;
    }

    .item-content p:last-child {
      color: #4b5563;
      font-size: 0.875rem;
    }

    .affirmation-box {
      background: linear-gradient(to bottom right, #8fbc8f, #6b8e23);
      border-radius: 1rem;
      padding: 1.5rem;
      box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
      margin-bottom: 1.5rem;
    }

    .affirmation-box p {
      color: white;
      text-align: center;
      font-weight: 500;
      font-style: italic;
      line-height: 1.6;
    }

    .chips-section {
      margin-top: auto;
    }

    .chips-label {
      color: #6b7280;
      font-size: 0.875rem;
      text-align: center;
      margin-bottom: 0.5rem;
    }

    .chip {
      width: 100%;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 9999px;
      padding: 0.75rem 1.25rem;
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      cursor: pointer;
      transition: all 0.2s;
      text-align: left;
    }

    .chip:hover {
      border-color: #99f6e4;
      background: #f0fdfa;
    }

    .chip-icon {
      width: 1.25rem;
      height: 1.25rem;
      color: #6b8e23;
      flex-shrink: 0;
    }

    .chip-text {
      color: #374151;
    }

    .conversation-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .xp-display {
      text-align: right;
    }

    .xp-display p:first-child {
      font-size: 0.875rem;
      color: #6b7280;
    }

    .xp-display p:last-child {
      font-size: 1.125rem;
      font-weight: 500;
      color: #6b8e23;
    }

    .conversation-thread {
      flex: 1;
      overflow-y: auto;
      margin-bottom: 1rem;
    }

    .context-card {
      background: white;
      border-radius: 1rem;
      padding: 1rem;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      border: 1px solid #e5e7eb;
      text-align: center;
      margin-bottom: 1rem;
    }

    .context-card p:first-child {
      font-size: 0.875rem;
      color: #6b7280;
    }

    .context-card p:last-child {
      font-weight: 500;
      color: #1f2937;
    }

    .message {
      margin-bottom: 1rem;
      display: flex;
    }

    .message.user {
      justify-content: flex-end;
    }

    .message.olivia {
      justify-content: flex-start;
    }

    .message-bubble {
      max-width: 80%;
      border-radius: 1rem;
      padding: 1rem;
    }

    .message.user .message-bubble {
      background: #6b8e23;
      color: white;
    }

    .message.olivia .message-bubble {
      background: white;
      border: 1px solid #e5e7eb;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .message-text {
      font-size: 0.875rem;
      line-height: 1.6;
    }

    .message.user .message-text {
      color: white;
    }

    .message.olivia .message-text {
      color: #374151;
    }

    .xp-badge {
      font-size: 0.75rem;
      color: #a8b896;
      margin-top: 0.5rem;
    }

    .input-area {
      display: flex;
      gap: 0.5rem;
    }

    .input-field {
      flex: 1;
      background: white;
      border: 1px solid #e5e7eb;
      border-radius: 9999px;
      padding: 0.75rem 1.25rem;
      font-size: 1rem;
      outline: none;
    }

    .input-field:focus {
      border-color: #99f6e4;
    }

    .send-btn {
      width: 3rem;
      height: 3rem;
      background: #6b8e23;
      color: white;
      border: none;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.2s;
    }

    .send-btn:hover {
      background: #556b2f;
    }

    .scrollable {
      overflow-y: auto;
      flex: 1;
    }

    .back-button {
      background: transparent;
      border: none;
      color: #6b7280;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: color 0.2s;
      margin-bottom: 1rem;
    }

    .back-button:hover {
      color: #6b8e23;
    }

    .back-button span {
      font-size: 0.875rem;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }

    .save-button {
      position: fixed;
      top: 1rem;
      right: 1rem;
      background: white;
      border: 2px solid #6b8e23;
      color: #6b8e23;
      padding: 0.75rem 1.5rem;
      border-radius: 9999px;
      font-size: 0.875rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      z-index: 1000;
    }

    .save-button:hover {
      background: #6b8e23;
      color: white;
      transform: scale(1.05);
    }

    .save-button.saved {
      background: #6b8e23;
      color: white;
      border-color: #6b8e23;
    }

    .save-icon {
      font-size: 1rem;
    }

    @media (max-width: 640px) {
      .save-button {
        padding: 0.5rem 1rem;
        font-size: 0.75rem;
      }
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <a href="chariot-showcase.html" style="position: fixed; top: 1rem; left: 1rem; background: rgba(107, 142, 35, 0.9); color: white; padding: 0.5rem 1rem; border-radius: 0.5rem; text-decoration: none; font-size: 0.875rem; font-weight: 600; box-shadow: 0 2px 8px rgba(0,0,0,0.2); z-index: 1000; display: flex; align-items: center; gap: 0.5rem; transition: all 0.2s;" onmouseover="this.style.background='#6b8e23'; this.style.transform='translateX(-3px)'" onmouseout="this.style.background='rgba(107, 142, 35, 0.9)'; this.style.transform='translateX(0)'">
    <span style="font-size: 1.2rem;">‚Üê</span>
    <span>Back to Showcase</span>
  </a>

  <script>
    // State
    let stage = 'welcome';
    let conversation = [];
    let relationshipXP = 0;
    let userMessage = '';
    let isFirstTime = true; // Set to false when coming from saved readings
    let isSaved = false;

    // Data
    const drawnCard = {
      id: 'the-chariot',
      name: 'The Chariot',
      number: 7,
      keywords: ['willpower', 'determination', 'control', 'victory'],
      strengths: [
        { label: 'Control', description: 'The ability to harness opposing forces' },
        { label: 'Initiative', description: 'Taking decisive action' },
        { label: 'Momentum', description: 'Using forward motion to maintain progress' }
      ],
      weaknesses: [
        { label: 'Rigidity', description: 'Being too focused on the destination' },
        { label: 'Burnout', description: 'Pushing too hard' },
        { label: 'Aggression', description: 'Letting drive override compassion' }
      ]
    };

    const oliviaContent = {
      dailyDrawIntro: "Okay wait‚ÄîThe Chariot? For you? Today? I love this. You know that thing you've been circling around, not sure if you should just GO for it? This is your sign. Not in a reckless way‚Äîin a 'you actually know what you want' way. Trust that. The only thing to watch? Don't push so hard you forget to breathe. You've got this, and I'm so here for it. üíô",
      affirmation: "I trust my direction. I move with intention and stay connected to what matters."
    };

    const questionChips = [
      { id: 'love', text: "What does this mean for love?" },
      { id: 'stuck', text: "I feel stuck though..." },
      { id: 'career', text: "How does this apply to my career?" }
    ];

    const responses = {
      love: {
        message: "Ooh, The Chariot in love is interesting! This isn't passive \"wait and see\" energy‚Äîit's about knowing what you want and moving toward it with intention. In relationships, that Control strength means you value clarity. You don't want to play games; you want to know where things are going. The flip side? That Rigidity can show up as being so focused on your vision that you miss what's actually unfolding. Are you in a situation right now where you're trying to control the outcome instead of letting it breathe a little?",
        xp: 2
      },
      stuck: {
        message: "Oof, I hear that. Sometimes getting a card about movement when you feel completely stuck is the most frustrating thing. And it's okay to feel that way‚ÄîI'm not going to tell you to \"just go for it\" when you're clearly in a different place right now. Here's what I will say: The Chariot doesn't always mean external movement. Sometimes it's about internal resolve‚Äîdeciding something, even if you can't act on it yet. What's actually keeping you stuck? Like, if you're honest with yourself, what's the real block?",
        xp: 3
      },
      career: {
        message: "Professionally, The Chariot is about taking initiative and driving projects forward. This is strong energy for leadership moments, pitching ideas, or navigating competitive situations. It asks: what would it look like to stop waiting for permission and start steering? Be mindful of burning out teammates or steamrolling collaboration in pursuit of your vision. Does that resonate with anything happening at work right now?",
        xp: 2
      }
    };

    // Render functions
    function renderWelcome() {
      return `
        <div class="container">
          <div class="header">
            <div class="avatar-icon">üåø</div>
            <div class="avatar-info">
              <h2>Olivia</h2>
              <p>Earth Guide ‚Ä¢ Level 1</p>
            </div>
          </div>

          <div class="content">
            <div class="message-box">
              <p>Hey! üíô So glad you're here. I'm Olivia, and I'm here to help you understand what your cards are trying to tell you.</p>
              <p>Here's the thing‚ÄîI'm not here to tell you what to do. I'm here to help you trust yourself. The cards? They're just a mirror for what you already know deep down.</p>
              <p>Ready for your first reading?</p>
            </div>

            <button class="btn-primary" onclick="nextStage('shuffling')">Draw My Card</button>
          </div>
        </div>
      `;
    }

    function renderShuffling() {
      setTimeout(() => nextStage('card-reveal'), 2000);
      return `
        <div class="shuffling-screen">
          <div class="shuffling-card"></div>
          <p class="shuffling-text">Shuffling your cards...</p>
        </div>
      `;
    }

    function renderCardReveal() {
      return `
        <div class="container">
          <div class="header">
            <div class="avatar-icon">üåø</div>
            <div class="avatar-info">
              <h2>Olivia</h2>
              <p>Earth Guide ‚Ä¢ Level 1</p>
            </div>
          </div>

          <div class="content">
            <div class="card-display">
              <div class="card-content">
                <p class="card-number">VII</p>
                <p class="card-name">THE CHARIOT</p>
              </div>
            </div>

            <div class="card-info">
              <h3>The Chariot</h3>
              <div class="keywords">
                ${drawnCard.keywords.map(k => `<span class="keyword">${k}</span>`).join('')}
              </div>
            </div>

            <button class="btn-primary" onclick="nextStage('interpretation')">What Does This Mean?</button>
          </div>
        </div>
      `;
    }

    function renderInterpretation() {
      return `
        ${!isFirstTime ? `
        <button class="save-button ${isSaved ? 'saved' : ''}" onclick="saveReading()">
          <span class="save-icon">${isSaved ? '‚úì' : '‚ô°'}</span>
          <span>${isSaved ? 'Saved' : 'Save Reading'}</span>
        </button>
        ` : ''}
        
        <div class="container">
          <div class="header">
            <div class="avatar-icon">üåø</div>
            <div class="avatar-info">
              <h2>Olivia</h2>
              <p>Earth Guide ‚Ä¢ Level 1</p>
            </div>
          </div>

          <div class="scrollable">
            <div class="mini-card">
              <div class="mini-card-img">VII</div>
              <div class="mini-card-info">
                <h3>The Chariot</h3>
                <p>Card 7 of 22 ‚Ä¢ Major Arcana</p>
              </div>
            </div>

            <div class="interpretation-box">
              <div class="olivia-message">
                <div class="olivia-avatar">üåø</div>
                <div class="olivia-text">${oliviaContent.dailyDrawIntro}</div>
              </div>
            </div>

            <div class="strengths-box">
              <h4>What to lean into</h4>
              ${drawnCard.strengths.map(s => `
                <div class="item">
                  <div class="dot dot-olive"></div>
                  <div class="item-content">
                    <p>${s.label}</p>
                    <p>${s.description}</p>
                  </div>
                </div>
              `).join('')}
              
              <h4 style="margin-top: 1.5rem;">What to watch for</h4>
              ${drawnCard.weaknesses.map(w => `
                <div class="item">
                  <div class="dot dot-amber"></div>
                  <div class="item-content">
                    <p>${w.label}</p>
                    <p>${w.description}</p>
                  </div>
                </div>
              `).join('')}
            </div>

            <div class="affirmation-box">
              <p>"${oliviaContent.affirmation}"</p>
            </div>
          </div>

          <div class="chips-section">
            <p class="chips-label">Ask me anything about this card</p>
            ${questionChips.map(chip => `
              <button class="chip" onclick="handleChipClick('${chip.id}')">
                <span class="chip-icon">üí¨</span>
                <span class="chip-text">${chip.text}</span>
              </button>
            `).join('')}
          </div>
        </div>
      `;
    }

    function renderConversation() {
      return `
        ${!isFirstTime ? `
        <button class="save-button ${isSaved ? 'saved' : ''}" onclick="saveReading()">
          <span class="save-icon">${isSaved ? '‚úì' : '‚ô°'}</span>
          <span>${isSaved ? 'Saved' : 'Save Reading'}</span>
        </button>
        ` : ''}
        
        <div class="container">
          <button class="back-button" onclick="goBack()">
            <span>‚Üê</span>
            <span>Back to reading</span>
          </button>
          
          <div class="conversation-header">
            <div class="header" style="margin: 0;">
              <div class="avatar-icon">üåø</div>
              <div class="avatar-info">
                <h2>Olivia</h2>
                <p>Earth Guide ‚Ä¢ Level 1</p>
              </div>
            </div>
            <div class="xp-display">
              <p>Relationship</p>
              <p>${relationshipXP} XP</p>
            </div>
          </div>

          <div class="conversation-thread">
            <div class="context-card">
              <p>You drew</p>
              <p>The Chariot</p>
            </div>

            ${conversation.map(msg => `
              <div class="message ${msg.speaker}">
                <div class="message-bubble">
                  <p class="message-text">${msg.text}</p>
                  ${msg.xp ? `<p class="xp-badge">+${msg.xp} XP</p>` : ''}
                </div>
              </div>
            `).join('')}
          </div>

          <div class="chips-section" style="margin-bottom: 1rem;">
            ${questionChips.filter(chip => !conversation.some(msg => msg.text === chip.text)).map(chip => `
              <button class="chip" onclick="handleChipClick('${chip.id}')">
                <span class="chip-icon">${chip.Icon ? 'üí¨' : ''}</span>
                <span class="chip-text">${chip.text}</span>
              </button>
            `).join('')}
          </div>

          <div class="input-area">
            <input 
              type="text" 
              class="input-field" 
              placeholder="Type your question..."
              id="messageInput"
              onkeypress="if(event.key==='Enter') sendMessage()"
            />
            <button class="send-btn" onclick="sendMessage()">
              ‚û§
            </button>
          </div>
        </div>
      `;
    }

    // Event handlers
    function nextStage(newStage) {
      stage = newStage;
      render();
    }

    function goBack() {
      stage = 'interpretation';
      render();
    }

    function saveReading() {
      // In production, this would call your API
      // For now, simulate save with localStorage
      const reading = {
        date: new Date().toISOString(),
        card: drawnCard,
        avatar: 'olivia',
        conversation: conversation,
        xp: relationshipXP
      };
      
      localStorage.setItem('lastReading', JSON.stringify(reading));
      isSaved = true;
      render();
      
      // Show confirmation
      setTimeout(() => {
        alert('‚úì Reading saved! You can find it in your journal.');
      }, 100);
    }

    function handleChipClick(chipId) {
      const chip = questionChips.find(c => c.id === chipId);
      const response = responses[chipId];
      
      conversation.push(
        { speaker: 'user', text: chip.text },
        { speaker: 'olivia', text: response.message, xp: response.xp }
      );
      relationshipXP += response.xp;
      
      nextStage('conversation');
    }

    function sendMessage() {
      const input = document.getElementById('messageInput');
      const message = input ? input.value.trim() : '';
      
      if (!message) return;
      
      conversation.push({ speaker: 'user', text: message });
      render();
      
      setTimeout(() => {
        conversation.push({
          speaker: 'olivia',
          text: "I'm listening. Tell me more about that‚Äîwhat's coming up for you?",
          xp: 1
        });
        relationshipXP += 1;
        render();
      }, 1000);
    }

    // Main render
    function render() {
      const app = document.getElementById('app');
      
      switch(stage) {
        case 'welcome':
          app.innerHTML = renderWelcome();
          break;
        case 'shuffling':
          app.innerHTML = renderShuffling();
          break;
        case 'card-reveal':
          app.innerHTML = renderCardReveal();
          break;
        case 'interpretation':
          app.innerHTML = renderInterpretation();
          break;
        case 'conversation':
          app.innerHTML = renderConversation();
          break;
      }
    }

    // Initial render
    render();
  </script>
</body>
</html>
