<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Majestic - Onboarding</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      background: #111827;
      min-height: 100vh;
    }

    .screen {
      display: none;
      min-height: 100vh;
    }

    .screen.active {
      display: flex;
    }

    /* Crystal Ball */
    .crystal-ball {
      position: relative;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      background: conic-gradient(from 0deg, #a855f7, #ec4899, #f59e0b, #10b981, #3b82f6, #a855f7);
      box-shadow: 0 0 30px rgba(168, 85, 247, 0.3);
    }

    .crystal-ball:hover {
      transform: scale(1.05);
    }

    .crystal-ball::before {
      content: '';
      position: absolute;
      inset: 8px;
      border-radius: 50%;
      background: linear-gradient(135deg, rgba(255,255,255,0.2), transparent);
    }

    .crystal-ball-small { width: 4rem; height: 4rem; }
    .crystal-ball-medium { width: 6rem; height: 6rem; }
    .crystal-ball-large { width: 10rem; height: 10rem; }

    .pulse {
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    /* Splash Screen */
    .splash-screen {
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 2rem;
    }

    .splash-title {
      font-size: 3rem;
      font-weight: 300;
      color: white;
      letter-spacing: 0.2em;
      margin: 2rem 0 0.5rem;
    }

    .splash-subtitle {
      color: #9ca3af;
      font-size: 1.125rem;
      font-weight: 300;
      font-style: italic;
    }

    .splash-hint {
      position: absolute;
      bottom: 3rem;
      color: #6b7280;
      font-size: 0.875rem;
    }

    /* Welcome Screen */
    .welcome-screen {
      flex-direction: column;
      padding: 3rem 1.5rem;
      position: relative;
    }

    .crystal-nav {
      position: absolute;
      top: 2rem;
      right: 1.5rem;
    }

    .welcome-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      text-align: center;
    }

    .welcome-title {
      font-size: 3rem;
      font-weight: 300;
      color: white;
      letter-spacing: 0.1em;
      margin-bottom: 1rem;
    }

    .steps-container {
      max-width: 28rem;
      margin: 3rem auto 0;
      text-align: left;
    }

    .step {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .step-number {
      width: 2rem;
      height: 2rem;
      border-radius: 50%;
      border: 2px solid white;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 300;
      flex-shrink: 0;
    }

    .step-content h3 {
      color: white;
      font-weight: 500;
      margin-bottom: 0.25rem;
    }

    .step-content p {
      color: #d1d5db;
      font-size: 0.875rem;
      line-height: 1.5;
    }

    .btn-primary {
      width: 100%;
      background: white;
      color: #111827;
      padding: 1rem;
      border-radius: 0.5rem;
      font-size: 1.125rem;
      font-weight: 500;
      border: none;
      cursor: pointer;
      transition: all 0.2s;
      margin-top: 2rem;
    }

    .btn-primary:hover {
      background: #f3f4f6;
    }

    /* Question Screen */
    .question-screen {
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 3rem 1.5rem;
    }

    .question-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .question-title {
      font-size: 2.5rem;
      font-weight: 300;
      color: #111827;
      letter-spacing: 0.3em;
      margin-bottom: 1.5rem;
    }

    .progress-dots {
      display: flex;
      gap: 0.5rem;
      justify-content: center;
      margin-bottom: 2rem;
    }

    .progress-dot {
      width: 0.5rem;
      height: 0.5rem;
      border-radius: 50%;
      background: #9ca3af;
      transition: all 0.3s;
    }

    .progress-dot.active {
      background: #111827;
    }

    .quiz-frame {
      background: #111827;
      border-radius: 1rem;
      padding: 1.5rem;
      max-width: 28rem;
      width: 100%;
    }

    .question-text {
      color: white;
      font-size: 1.125rem;
      font-weight: 300;
      line-height: 1.6;
      text-align: center;
      margin-bottom: 1.5rem;
    }

    .options-list {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .option-btn {
      background: #1f2937;
      border: 1px solid #374151;
      border-radius: 0.5rem;
      padding: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      cursor: pointer;
      transition: all 0.2s;
      text-align: left;
    }

    .option-btn:hover {
      background: #374151;
      border-color: #4b5563;
    }

    .option-icon {
      font-size: 1.125rem;
    }

    .option-text {
      color: white;
      font-weight: 300;
      font-size: 0.875rem;
    }

    /* Recommendation Screen */
    .recommendation-screen {
      flex-direction: column;
      padding: 3rem 1.5rem;
      position: relative;
    }

    .recommendation-header {
      text-align: center;
      margin: 4rem 0 2rem;
    }

    .recommendation-title {
      font-size: 2.5rem;
      font-weight: 300;
      color: white;
      letter-spacing: 0.1em;
    }

    .recommendation-subtitle {
      color: #9ca3af;
      margin-top: 1rem;
    }

    .avatar-card {
      background: #1f2937;
      border: 2px solid #374151;
      border-radius: 1rem;
      padding: 2rem;
      text-align: center;
      margin-bottom: 1.5rem;
      position: relative;
      transition: all 0.3s;
    }

    .avatar-card.recommended {
      border-color: #fbbf24;
    }

    .recommended-badge {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: #fbbf24;
      color: #111827;
      font-size: 0.75rem;
      padding: 0.25rem 0.5rem;
      border-radius: 9999px;
      font-weight: 700;
    }

    .avatar-icon-large {
      font-size: 4rem;
      margin-bottom: 1rem;
    }

    .avatar-name {
      font-size: 2rem;
      font-weight: 300;
      color: white;
      margin-bottom: 0.5rem;
    }

    .avatar-element {
      color: #9ca3af;
      font-size: 1.125rem;
      margin-bottom: 1.5rem;
    }

    .avatar-quote {
      background: #111827;
      border: 1px solid #374151;
      border-radius: 0.75rem;
      padding: 1rem;
    }

    .avatar-quote p {
      color: #d1d5db;
      font-size: 0.875rem;
      line-height: 1.6;
      font-style: italic;
    }

    .btn-secondary {
      width: 100%;
      background: transparent;
      color: #9ca3af;
      padding: 0.75rem;
      border: none;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s;
      margin-top: 0.75rem;
    }

    .btn-secondary:hover {
      color: #d1d5db;
    }

    .explore-section {
      background: #1f2937;
      border: 2px solid #374151;
      border-radius: 1rem;
      padding: 1rem;
    }

    .explore-label {
      color: #9ca3af;
      font-size: 0.875rem;
      text-align: center;
      margin-bottom: 1rem;
    }

    .avatar-grid {
      display: flex;
      justify-content: center;
      gap: 0.75rem;
    }

    .avatar-mini {
      background: #374151;
      border: 1px solid #4b5563;
      border-radius: 0.75rem;
      padding: 0.75rem;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 1.5rem;
    }

    .avatar-mini:hover {
      border-color: #6b7280;
      transform: scale(1.1);
    }

    .disclaimer {
      color: #6b7280;
      font-size: 0.75rem;
      text-align: center;
      margin-top: 1rem;
    }

    /* Confirmation Screen */
    .confirmation-screen {
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 3rem 1.5rem;
      text-align: center;
    }

    .confirmation-icon {
      font-size: 5rem;
      margin-bottom: 1.5rem;
    }

    .confirmation-title {
      font-size: 2.5rem;
      font-weight: 300;
      color: white;
      letter-spacing: 0.1em;
      margin-bottom: 1rem;
    }

    .confirmation-subtitle {
      font-size: 1.5rem;
      font-weight: 300;
      color: #d1d5db;
      margin-bottom: 1.5rem;
    }

    .confirmation-description {
      color: #9ca3af;
      line-height: 1.6;
      max-width: 28rem;
      margin-bottom: 2rem;
    }

    /* Transitions */
    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <script>
    // State
    let currentStep = 0;
    let answers = [];
    let recommendedAvatar = null;
    let selectedAvatar = null;
    let currentHero = null;

    // Avatar data
    const avatars = {
      olivia: {
        name: 'Olivia',
        element: 'Earth',
        emoji: 'ðŸŒ±',
        description: 'Grounded wisdom and practical insights',
        personality: 'I guide with nurturing stability and help you build solid foundations.'
      },
      elijah: {
        name: 'Elijah',
        element: 'Air',
        emoji: 'ðŸ’¨',
        description: 'Balanced philosophy and structured guidance',
        personality: 'I offer clarity through balanced perspective and thoughtful analysis.'
      },
      destiny: {
        name: 'Destiny',
        element: 'Water',
        emoji: 'ðŸŒŠ',
        description: 'Intuitive flow and emotional wisdom',
        personality: 'I help you trust your intuition and flow with life's currents.'
      },
      casper: {
        name: 'Casper',
        element: 'Fire',
        emoji: 'ðŸ”¥',
        description: 'Passionate action and bold transformation',
        personality: 'I ignite your inner fire and guide you to take empowered action.'
      }
    };

    // Questions
    const questions = [
      {
        question: "When life feels uncertain, you tend toâ€¦",
        options: [
          { text: "Take bold action and trust your instincts", avatar: 'casper', icon: 'ðŸ”¥' },
          { text: "Flow with the changes and feel your way through", avatar: 'destiny', icon: 'ðŸŒŠ' },
          { text: "Ground yourself and plan practical next steps", avatar: 'olivia', icon: 'ðŸŒ±' },
          { text: "Step back, breathe, and find balance", avatar: 'elijah', icon: 'ðŸ’¨' }
        ]
      },
      {
        question: "Your ideal guidance feelsâ€¦",
        options: [
          { text: "Direct and empowering - 'Here's what to do'", avatar: 'casper', icon: 'ðŸ”¥' },
          { text: "Intuitive and flowing - 'Trust what you feel'", avatar: 'destiny', icon: 'ðŸŒŠ' },
          { text: "Practical and nurturing - 'Let's build this together'", avatar: 'olivia', icon: 'ðŸŒ±' },
          { text: "Balanced and wise - 'Consider all perspectives'", avatar: 'elijah', icon: 'ðŸ’¨' }
        ]
      }
    ];

    // Calculate recommendation
    function calculateRecommendation(answers) {
      const counts = {};
      answers.forEach(answer => {
        counts[answer] = (counts[answer] || 0) + 1;
      });
      return Object.keys(counts).reduce((a, b) => counts[a] > counts[b] ? a : b);
    }

    // Navigation
    function nextStep() {
      currentStep++;
      render();
    }

    function handleAnswer(avatarKey) {
      answers.push(avatarKey);
      
      if (currentStep < questions.length + 1) {
        setTimeout(() => {
          nextStep();
        }, 300);
      }
      
      if (answers.length === questions.length) {
        recommendedAvatar = calculateRecommendation(answers);
        currentHero = recommendedAvatar;
      }
    }

    function handleHeroSwap(avatarKey) {
      currentHero = avatarKey;
      render();
    }

    function handleAvatarSelect(avatarKey) {
      selectedAvatar = avatarKey;
      nextStep();
    }

    function goToReading() {
      // In production, this would navigate to the reading
      window.parent.postMessage({ action: 'navigate', page: 'showcase' }, '*');
    }

    // Render functions
    function renderSplash() {
      return `
        <div class="screen active splash-screen">
          <div class="crystal-ball crystal-ball-large pulse" onclick="nextStep()"></div>
          <h1 class="splash-title">MAJESTIC</h1>
          <p class="splash-subtitle">Explore your spiritual path</p>
          <p class="splash-hint">Tap the crystal ball to begin</p>
        </div>
      `;
    }

    function renderWelcome() {
      return `
        <div class="screen active welcome-screen">
          <div class="crystal-nav">
            <div class="crystal-ball crystal-ball-medium" onclick="nextStep()"></div>
          </div>
          
          <div class="welcome-content">
            <h1 class="welcome-title">HOW WILL IT</h1>
            <h1 class="welcome-title">WðŸ”®RK?</h1>
            
            <div class="steps-container">
              <div class="step">
                <div class="step-number">1</div>
                <div class="step-content">
                  <h3>Answer two questions</h3>
                  <p>We'll sense your spiritual energy and recommend your guide</p>
                </div>
              </div>
              
              <div class="step">
                <div class="step-number">2</div>
                <div class="step-content">
                  <h3>Choose your avatar</h3>
                  <p>Select from four elemental guides, each with unique wisdom</p>
                </div>
              </div>
              
              <div class="step">
                <div class="step-number">3</div>
                <div class="step-content">
                  <h3>Begin your journey</h3>
                  <p>Receive personalized tarot guidance and spiritual insights</p>
                </div>
              </div>
            </div>
            
            <button class="btn-primary" onclick="nextStep()">Begin Journey</button>
          </div>
        </div>
      `;
    }

    function renderQuestion(questionIndex) {
      const question = questions[questionIndex];
      
      return `
        <div class="screen active question-screen" style="background: #f3f4f6;">
          <div class="question-header">
            <h1 class="question-title">MAJESTIC</h1>
            <div class="crystal-ball crystal-ball-medium" style="margin: 0 auto;"></div>
            
            <div class="progress-dots">
              ${questions.map((_, i) => `
                <div class="progress-dot ${i <= questionIndex ? 'active' : ''}"></div>
              `).join('')}
            </div>
          </div>
          
          <div class="quiz-frame fade-in">
            <h2 class="question-text">${question.question}</h2>
            
            <div class="options-list">
              ${question.options.map(option => `
                <button class="option-btn" onclick="handleAnswer('${option.avatar}')">
                  <span class="option-icon">${option.icon}</span>
                  <span class="option-text">${option.text}</span>
                </button>
              `).join('')}
            </div>
          </div>
        </div>
      `;
    }

    function renderRecommendation() {
      const hero = avatars[currentHero];
      const isRecommended = currentHero === recommendedAvatar;
      
      return `
        <div class="screen active recommendation-screen">
          <div class="crystal-nav">
            <div class="crystal-ball crystal-ball-medium"></div>
          </div>
          
          <div class="recommendation-header">
            <h1 class="recommendation-title">MEET YOUR</h1>
            <h1 class="recommendation-title">GUIDE</h1>
            <p class="recommendation-subtitle">& begin your spiritual journey</p>
          </div>
          
          <div class="avatar-card ${isRecommended ? 'recommended' : ''} fade-in">
            ${isRecommended ? '<div class="recommended-badge">Recommended</div>' : ''}
            
            <div class="avatar-icon-large">${hero.emoji}</div>
            <h3 class="avatar-name">${hero.name}</h3>
            <p class="avatar-element">${hero.element}</p>
            
            <div class="avatar-quote">
              <p>"${hero.personality}"</p>
            </div>
          </div>
          
          <button class="btn-primary" onclick="handleAvatarSelect('${currentHero}')">
            Choose ${hero.name}
          </button>
          
          <button class="btn-secondary" onclick="handleAvatarSelect('${recommendedAvatar}')">
            Skip - Use Quiz Result (${avatars[recommendedAvatar].name})
          </button>
          
          <div class="explore-section" style="margin-top: 1.5rem;">
            <p class="explore-label">Or explore other guides</p>
            <div class="avatar-grid">
              ${Object.entries(avatars)
                .filter(([key]) => key !== currentHero)
                .map(([key, avatar]) => `
                  <button class="avatar-mini" onclick="handleHeroSwap('${key}')">
                    ${avatar.emoji}
                  </button>
                `).join('')}
            </div>
          </div>
          
          <p class="disclaimer">You can change this anytime later</p>
        </div>
      `;
    }

    function renderConfirmation() {
      const selected = avatars[selectedAvatar];
      
      return `
        <div class="screen active confirmation-screen">
          <div class="confirmation-icon">${selected.emoji}</div>
          <h2 class="confirmation-title">WELCOME</h2>
          <h3 class="confirmation-subtitle">${selected.element} Seeker</h3>
          <p class="confirmation-description">
            ${selected.name} will guide your readings with ${selected.description.toLowerCase()}.
          </p>
          
          <div class="avatar-quote" style="max-width: 28rem; margin-bottom: 2rem;">
            <p>"${selected.personality}"</p>
          </div>
          
          <button class="btn-primary" onclick="goToReading()">
            Begin Your First Reading
          </button>
        </div>
      `;
    }

    // Main render
    function render() {
      const app = document.getElementById('app');
      
      if (selectedAvatar) {
        app.innerHTML = renderConfirmation();
      } else if (currentStep === 0) {
        app.innerHTML = renderSplash();
      } else if (currentStep === 1) {
        app.innerHTML = renderWelcome();
      } else if (currentStep >= 2 && currentStep <= 3) {
        app.innerHTML = renderQuestion(currentStep - 2);
      } else if (currentStep === 4) {
        app.innerHTML = renderRecommendation();
      }
    }

    // Initialize
    render();

    // Listen for navigation messages from parent
    window.addEventListener('message', (event) => {
      if (event.data.action === 'reset') {
        currentStep = 0;
        answers = [];
        recommendedAvatar = null;
        selectedAvatar = null;
        currentHero = null;
        render();
      }
    });
  </script>
</body>
</html>
